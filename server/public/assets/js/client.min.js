/*! sportngin 2016-05-30 */
var app=angular.module("tryoutsApp",["ngRoute","angular-loading-bar","mobile-angular-ui","mobile-angular-ui.gestures","pickadate"]);app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"/app/view/",controller:"HomeController",controllerAs:"home"}).when("/logout",{templateUrl:"/app/view/",controller:"LogoutController",controllerAs:"logout"}).when("/archives",{templateUrl:"/app/view/archives",controller:"ArchivesController",controllerAs:"archive"}).when("/new",{templateUrl:"/app/view/new",controller:"TryoutInputController",controllerAs:"input"}).when("/edit/:id",{templateUrl:"/app/view/edit/",controller:"EditController",controllerAs:"edit"}).when("/players/:id",{templateUrl:"/app/view/players",controller:"PlayerNumberController",controllerAs:"num"}).when("/tryout/:id",{templateUrl:"/app/view/tryout",controller:"TryoutReviewController",controllerAs:"review"}).when("/scoreplayer/:id/:player",{templateUrl:"/app/view/scoreplayer",controller:"AssignScoreController",controllerAs:"assign"}).otherwise({templateUrl:"/app/view/404",controller:"ErrorController",controllerAs:"error"}),b.html5Mode(!0)}]),app.controller("AssignScoreController",["TryoutService","$routeParams","$scope",function(a,b,c){var d=this;d.player=a.data;var e=a.data,f={player_id:b.player,tryout_id:b.id};d.calcTotal=function(){for(var a=d.player.val.players[0].categories,b=0,c=0;c<a.length;c++)a[c].score&&(b+=a[c].score);d.player.val.players[0].total=b},d.saveScoresAndTotal=function(b){a.saveTotal(b,f.tryout_id)},d.reset=function(){d.player=angular.copy(e),console.log(d.player),c.scoreForm.$setPristine()},a.getOnePlayer(f)}]),app.controller("TryoutReviewController",["$routeParams","TryoutService",function(a,b){var c=this;c.playerInfo={tryout_id:""},c.displayTryout=b.data,c.playerInfo.tryout_id=a.id,c.reviewPlayer=function(a){c.playerInfo.player_id=a.player_id,b.scorePlayer(c.playerInfo)},c.editTryout=function(){b.editThisTryout(c.playerInfo.tryout_id)},b.fetchOneTryout(c.playerInfo.tryout_id)}]),app.controller("PlayerNumberController",["$routeParams","TryoutService",function(a,b){var c=this;c.playerProfiles=[],c.playersList=b.data,c.tryout_id=a.id,c.savePlayers=function(){for(var a=0;a<c.playersList.val.length;a++)c.playerTryout={jerseyNum:"",profiles:{}},c.playerTryout.profiles.survey_id=c.playersList.val[a].survey_result_id,c.playerTryout.profiles.first_name=c.playersList.val[a].qu_el_3797779,c.playerTryout.profiles.last_name=c.playersList.val[a].qu_el_3797780,c.playerTryout.profiles.level=c.playersList.val[a].qu_el_3797961,c.playerTryout.jerseyNum=c.playersList.val[a].alias,c.playerProfiles.push(c.playerTryout);b.savePlayersToDb(c.playerProfiles,c.tryout_id)},c.back=function(){},b.getPlayers()}]),app.controller("AppController",["UserService",function(a){var b=this;b.user=a.user,a.isAuthenticated(function(a,b){console.log(a)})}]),app.controller("HomeController",["$http","UserService","TryoutService","$location","$timeout","cfpLoadingBar",function(a,b,c,d,e,f){var g=this;g.tryouts=[],g.guest={},g.tryoutToDelete={},g.tryouts=c.data,b.isAuthenticated(function(a){a===!0&&(c.fetchTryouts(),g.generateGuestCode=function(a){c.generateCode(a)},g.deleteTryout=function(a){c.deleteTryout(a)},g.reviewTryout=function(a){c.reviewATryout(a)},g.createNew=function(){c.inputTryout()})}),g.guestLogin=function(){b.guestAuthentication(g.guest,function(a){a===!0?console.log("Code worked!"):console.log(":(")})},f.start(),g.fakeIntro=!0,e(function(){f.complete(),g.fakeIntro=!1},1250)}]),app.controller("TryoutInputController",["TryoutService","UserService","$location","$routeParams",function(a,b,c,d){var e=this;b.isAuthenticated(function(b){if(b===!0){var d=1;e.tryout={},e.categories=[{id:1}],e.currDate=new Date,e.addField=function(){d+=1,e.categories.push({id:d})},e.removeField=function(a){e.categories.splice(a,1)},e.submitInfo=function(){e.tryout.categories=e.categories,a.saveTryoutInfo(e.tryout)},e.back=function(){window.history.back()}}else c.path("/")})}]),app.controller("EditController",["TryoutService","$routeParams","$scope",function(a,b,c){var d=this,e=a.data;d.tryoutData=e,d.tryout_id=b.id;var f=d.tryoutData.val.categories.length+1;console.log(d.tryout_id),d.addField=function(){f+=1,d.tryoutData.val.categories.push({id:f})},d.removeField=function(a){d.tryoutData.val.categories.splice(a,1)},d.reset=function(){d.tryoutData=angular.copy(e),console.log(d.tryoutData),c.editForm.$setPristine()},d.saveEdits=function(){a.saveTryoutEdits(d.tryoutData.val)},a.fetchOneTryout(d.tryout_id)}]),app.controller("LogoutController",["UserService","$templateCache","$location",function(a,b,c){b.removeAll(),a.isAuthenticated(function(b){b===!0?a.logout(function(){c.path("/")}):c.path("/")})}]),app.controller("ArchivesController",function(){}),app.controller("ErrorController",function(){}),app.factory("UserService",["$http",function(a){var b={},c=function(b){a.get("/auth/logout").then(function(a){b()})},d=function(c){a.get("/auth/check").then(function(a){a.data.success===!0?(b.data=a.data.user,c(!0,a.data)):(b.data=a.data,c(!1))})},e=function(c,d){a.post("/auth/guest",c).then(function(a){console.log(a),b.guest=a.data.guest,d(!0)},function(a){d(!1)})};return{user:b,logout:c,isAuthenticated:d,guestAuthentication:e}}]),app.factory("TryoutService",["$http","$location",function(a,b){var c={},d=function(c){a.post("/app/view/new",c).then(function(a){b.path("/players/"+a.data._id)})},e=function(b){a.get("/app/view/guestcode/"+b._id).then(function(a){g()})},f=function(){a.get("/app/view/players/testAPI").then(function(a){c.val=a.data})},g=function(){a.get("/app/view/data").then(function(a){c.val=a.data})},h=function(b){a["delete"]("/app/view/"+b._id).then(function(a){g()})},i=function(c,d){a.put("/app/view/players/"+d,c).then(function(a){b.path("/tryout/"+d)})},j=function(a){b.path("/scoreplayer/"+a.tryout_id+"/"+a.player_id)},k=function(b){var d={params:{tryout_id:b.tryout_id,player_id:b.player_id}};a.get("/app/view/scoreplayer/input/",d).then(function(a){c.val=a.data})},l=function(b){a.get("/app/view/tryout/get/"+b).then(function(a){c.val=a.data})},m=function(c,d){a.put("/app/view/scoreplayer/"+d,c).then(function(a){b.path("/tryout/"+d)})},n=function(a){b.path("/tryout/"+a._id)},o=function(){b.path("/new/")},p=function(a){b.path("/edit/"+a)},q=function(c){a.put("/app/view/edit/"+c._id,c).then(function(a){b.path("/tryout/"+c._id)})};return{saveTryoutInfo:d,generateCode:e,fetchTryouts:g,deleteTryout:h,savePlayersToDb:i,scorePlayer:j,getPlayers:f,getOnePlayer:k,fetchOneTryout:l,saveTotal:m,reviewATryout:n,inputTryout:o,editThisTryout:p,saveTryoutEdits:q,data:c}}]);